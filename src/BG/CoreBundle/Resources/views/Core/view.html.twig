{% extends "BGCoreBundle::layout.html.twig" %}

{% block body %}

  {{ include('BGCoreBundle::menu.html.twig', { 'route': 'BG_CoreBundle_home', 'parameters': {}  }) }}

  <div class="container-fluid card wizard-card" data-color="blue">

    <h2 class="row form-signin-heading justify-content-center">Devis N°{{ quote.id }}</h2>

    <button type="button" class="btn btn-{{ quote.status.type }}">{{ quote.status.message }}</button>

    <div class="row">
      <div class="col">
        <div class="dropdown">
          <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Actions</button>
          <div class="dropdown-menu">
             <a class="dropdown-item" href="{{ path('BG_CoreBundle_slips', {'id': quote.id}) }}">Historique des bordereaux</a>
             <h6 class="dropdown-header">Changer le status</h6>
             <a class="dropdown-item" href="{{ path('BG_CoreBundle_changestatus', {'id': quote.id, 'status': 'awaiting'}) }}">En attente</a>
             <a class="dropdown-item" href="{{ path('BG_CoreBundle_changestatus', {'id': quote.id, 'status': 'ongoing'}) }}">En cours</a>
             <a class="dropdown-item" href="{{ path('BG_CoreBundle_changestatus', {'id': quote.id, 'status': 'finished'}) }}">Terminé</a>
             <a class="dropdown-item" href="{{ path('BG_CoreBundle_changestatus', {'id': quote.id, 'status': 'cancelled'}) }}">Annulé</a>
          </div>
        </div>
      </div>
      <div class="col d-flex justify-content-end align-self-center">
        <a href="{{ path('BG_CoreBundle_modifyquote', {'id': quote.id}) }}"><i class="fas fa-cog"></i></a>
      </div>
    </div>


    <div class="table-responsive">
        <table class="table table-striped">
          <thead>
            <tr>
              <th><div id="checkAll" class="check"><label><input type="checkbox" name="optionsCheckboxes"></label> Sélection</div></th>
              <th>Désignation</th>
              <th>Indice</th>
              <th>Avancement global</th>
              <th>Temps ingénieur</th>
              <th>Temps dessinateur</th>
            </tr>
          </thead>
          <tbody>
        {% for building in quote.buildings %}
          <tr>
            <td colspan="6"><h1 class="small">Bâtiment N°{{ building.num }}</h1></td>
          </tr>
          {% for service in building.services %}
            {% if service.isUsed %}
              <tr>
                <td><div class="check"><label><input type="checkbox" name="optionsCheckboxes"></label></div></td>
                <td>{{ service.level }} - {{ service.drawing }}</td>
                <td>{{ service.grade|index }}</td>
                <td>{{ service.advancement }}</td>
                <td>{{ service.engTime }}</td>
                <td>{{ service.drawTime }}</td>
              </tr>
            {% endif %}
          {% endfor %}
        {% endfor %}

    </tbody>
  </table>
</div>

  </div>

{{ parent() }}

{% endblock %}
